from unittest import TestCase

from profile_generator.main.profile_params import ProfileParams

from .grading import profile_generator_test as grading_test
from .profile_generator import generate
from .white_balance import profile_generator_test as wb_test

_DEFAULT = {
    "LCEnabled": "false",
    "ACurve": "0;",
    "BCurve": "0;",
    **wb_test.DEFAULT,
    **grading_test.DEFAULT,
}


class ProfileGeneratorTest(TestCase):
    def test_generate_defaults(self) -> None:
        self.assertEqual(generate(ProfileParams()), _DEFAULT)

    def test_generate_vibrance(self) -> None:
        profile_params = ProfileParams()
        profile_params.parse({"colors": {"vibrance": 5}})

        self.assertEqual(
            generate(profile_params),
            _DEFAULT
            | {
                "LCEnabled": "true",
                "ACurve": "4;0.0000000;0.0000000;0.0431373;0.0206230;"
                + "0.0862745;0.0444534;0.1294118;0.0719773;0.1686275;"
                + "0.1006289;0.2078431;0.1331157;0.2431373;0.1658941;"
                + "0.2784314;0.2021936;0.3098039;0.2374625;0.3411765;"
                + "0.2755018;0.3725490;0.3161441;0.4039216;0.3590974;"
                + "0.4313725;0.3982499;0.4588235;0.4384954;0.4862745;"
                + "0.4794215;0.5137255;0.5205785;0.5411765;0.5615046;"
                + "0.5686275;0.6017501;0.5960784;0.6409026;0.6274510;"
                + "0.6838559;0.6588235;0.7244982;0.6901961;0.7625375;"
                + "0.7215686;0.7978064;0.7568627;0.8341059;0.7921569;"
                + "0.8668843;0.8313725;0.8993711;0.8705882;0.9280227;"
                + "0.9137255;0.9555466;0.9568627;0.9793770;1.0000000;1.0000000;",
                "BCurve": "4;0.0000000;0.0000000;0.0431373;0.0206230;"
                + "0.0862745;0.0444534;0.1294118;0.0719773;0.1686275;"
                + "0.1006289;0.2078431;0.1331157;0.2431373;0.1658941;"
                + "0.2784314;0.2021936;0.3098039;0.2374625;0.3411765;"
                + "0.2755018;0.3725490;0.3161441;0.4039216;0.3590974;"
                + "0.4313725;0.3982499;0.4588235;0.4384954;0.4862745;"
                + "0.4794215;0.5137255;0.5205785;0.5411765;0.5615046;"
                + "0.5686275;0.6017501;0.5960784;0.6409026;0.6274510;"
                + "0.6838559;0.6588235;0.7244982;0.6901961;0.7625375;"
                + "0.7215686;0.7978064;0.7568627;0.8341059;0.7921569;"
                + "0.8668843;0.8313725;0.8993711;0.8705882;0.9280227;"
                + "0.9137255;0.9555466;0.9568627;0.9793770;1.0000000;1.0000000;",
            },
        )
